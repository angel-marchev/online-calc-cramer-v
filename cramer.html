<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cramer's V Calculation</title>
</head>
<body>
    <h1 align="center">Cramer's V Calculations</h1>
    <p align="justify" style="margin-left:30%;margin-right:30%;">This online calculator addresses 
        the issue of objectivity in the choice of proper sizes of association’s strength between 
        categorical variables, applying Cramér’s coefficient, V. The calculator could be used in two ways: 
        to calculate Cramer cutoff values or to calculate strength of association for an observed 
        Cramer value. So in order to use it either effect sizes or observed Cramer's V value must be provided.
        The input cells are initially loaded with test values, which could be changed. All inputs are automatically 
        validated. The calculator's method and all details are published in the following paper:<br><br>
                Cite:<br><i>Haralampiev, K., D. Blagoev, 2025. Reconsidering Cramér’s Measure of Association. AIP Conference Proceedings</i></p>
    <div class="tg-wrap"><table border="1" cellspacing="0" cellpadding="10" align="center"><tbody>
    <form id="cramerForm">
        <tr>
            <td colspan="2">
                <p align="justify">These fields the always needed for both posible ways of using<br>
                    the calculator. The number of categories of the independent and<br>
                    dependent variable are input. They must be integers greater than 1.</p>
                <label for="independent">Number of categories of the independent variable:</label>
                <input type="number" id="independent" name="independent" step="1" value="2" style="width: 30px;" required><br><br>
        
                <label for="dependent">Number of categories of the dependent variable:</label>
                <input type="number" id="dependent" name="dependent" step="1" value="2" style="width: 30px;" required><br><br>
            </td>
        </tr>
        <tr>
            <td valign="top">
                <p>To calculate the Cramer cutoffs,<br>
                   input the effect size values.<br>
                   Values for effect sizes must be<br>
                   between 0 and 1. Also they must<br>
                   in monotonous order.</p>
                <label for="smallEffect">Small effect size:</label>
                <input type="number" id="smallEffect" name="smallEffect" step="0.01" value="0.05" style="width: 50px;"><br><br>

                <label for="mediumEffect">Medium effect size:</label>
                <input type="number" id="mediumEffect" name="mediumEffect" step="0.01" value="0.15" style="width: 50px;"><br><br>

                <label for="largeEffect">Large effect size:</label>
                <input type="number" id="largeEffect" name="largeEffect" step="0.01" value="0.25" style="width: 50px;"><br><br>
            </td>
            <td valign="top">
                <p>To estimate the effect size,<br>
                    input the Cramer's coefficient<br>
                    as calculated from the data.<br>
                    Values for observed Cramer's V<br>
                    must be between 0 and 1.<br></p>
                <label for="observed">Observed Cramer's V:</label>
                <input type="number" id="observed" name="observed" step="0.01" value="0.5" style="width: 50px;"><br><br>
            </td>
        </tr>
        <tr>
            <td colspan="2">
                <p align="center"> When all needed inputs are set, press "Calculate" to validate all<br>
                   cells and get the results. Note, that the Cramer's coefficient<br>
                   can not take values above 1</p>
                <button type="button" style="position: relative; left: 40%;" onclick="calculate()">Calculate</button>
            
    
    </form>
    
    <h3>Results:</h3>
    <div id="results"></div>

    <script>
        const formulas = {
            J7: (I7, C8, C9, C10, E12, E13, E14, E15) => 
                I7 === "" ? "" : 
                C8 === "" ? "" : 
                C9 === "" ? "" : 
                C10 === "" ? "" : 
                I7 < C8 ? E12 : 
                I7 < C9 ? E13 : 
                I7 < C10 ? E14 : E15,
            C8: (I2, I3, B8) => 
                I2 === "" ? "" : 
                I3 === "" ? "" : 
                B8 === "" ? "" : I3 * B8 / 2 / Math.sqrt(Math.min(I2 - 1, I3 - 1)),
            C9: (I2, I3, B9) => 
                I2 === "" ? "" : 
                I3 === "" ? "" : 
                B9 === "" ? "" : I3 * B9 / 2 / Math.sqrt(Math.min(I2 - 1, I3 - 1)),
            I9: (I2, I3, I7) => 
                I2 === "" ? "" : 
                I3 === "" ? "" : 
                I7 === "" ? "" : 2 * I7 * Math.sqrt(Math.min(I2 - 1, I3 - 1)) / I3,
            J9: (I9) => 
                I9 === "" ? "" : `(${Math.round(I9 * 100)} percentage points)`,
            C10: (I2, I3, B10) => 
                I2 === "" ? "" : 
                I3 === "" ? "" : 
                B10 === "" ? "" : I3 * B10 / 2 / Math.sqrt(Math.min(I2 - 1, I3 - 1)),
            D12: (C8) => C8 >= 1 ? "-" : C8.toFixed(3),
            B13: (C8) => C8 >= 1 ? "-" : C8.toFixed(3),
            D13: (C9) => C9 >= 1 ? "-" : C9.toFixed(3),
            B14: (C9) => C9 >= 1 ? "-" : C9.toFixed(3),
            D14: (C10) => C10 >= 1 ? "-" : C10.toFixed(3),
            B15: (C10) => C10 >= 1 ? "-" : C10.toFixed(3)
        };

        const validations = {
            I2: (value) => Number.isInteger(value) && value > 1,
            I3: (value) => Number.isInteger(value) && value > 1,
            B8: (value) => value >= 0 && value <= 1,
            I7: (value) => value >= 0 && value <= 1,
            B9: (value, B8) => value > B8 && value <= 1,
            B10: (value, B9) => value > B9 && value <= 1
        };

        function calculate() {
            const I2 = parseFloat(document.getElementById('independent').value);
            const I3 = parseFloat(document.getElementById('dependent').value);
            const I7 = parseFloat(document.getElementById('observed').value);
            const B8 = parseFloat(document.getElementById('smallEffect').value);
            const B9 = parseFloat(document.getElementById('mediumEffect').value);
            const B10 = parseFloat(document.getElementById('largeEffect').value);

            // Validate obligatory inputs
            if (!validations.I2(I2) || !validations.I3(I3)) {
                alert('Independent and Dependent number of categories are obligatory and must be integers greater than 1.');
                return;
            }

            // Validate that either effect sizes or observed value are provided
            const effectSizesProvided = !isNaN(B8) && !isNaN(B9) && !isNaN(B10);
            const observedProvided = !isNaN(I7);

            if (!effectSizesProvided && !observedProvided) {
                alert('Either effect sizes OR observed Cramer\'s V value must be provided.');
                return;
            }

            // Validate the relationship between effect sizes
            if (effectSizesProvided && !(validations.B9(B9, B8) && validations.B10(B10, B9))) {
                alert('Values for effect sizes must be between 0 and 1. Additionally, effect sizes must satisfy: small < medium < large.');
                return;
            }

            // Validate the relationship between effect sizes
            if (observedProvided && !(validations.I7(I7))) {
                alert('Values for observed Cramer\'s V must be between 0 and 1.');
                return;
            }

            
            // Calculate intermediate values
            let resultsHtml = '';

            if (effectSizesProvided) {
                const C8 = formulas.C8(I2, I3, B8);
                const C9 = formulas.C9(I2, I3, B9);
                const C10 = formulas.C10(I2, I3, B10);
                
                const intervalC8 = C8 >= 1 ? 1 : C8.toFixed(3);
                const intervalC9 = C9 >= 1 ? 1 : C9.toFixed(3);
                const intervalC10 = C10 >= 1 ? 1 : C10.toFixed(3);

                const weakAssociation = intervalC8 >= 1 ? 'Impossible value' : `Between ${intervalC8} and ${intervalC9}: Weak association`;
                const moderateAssociation = intervalC9 >= 1 ? 'Impossible value' : `Between ${intervalC9} and ${intervalC10}: Moderate association`;
                const strongAssociation = intervalC10 >= 1 ? 'Impossible value' : `${intervalC10} and more: Strong association`;

                resultsHtml += `
                    <p>Cutoff values of Cramer's V for ...</p>
                    <p>... small effect size: ${C8 >= 1 ? "-" : C8.toFixed(3)}</p>
                    <p>... medium effect size: ${C9 >= 1 ? "-" : C9.toFixed(3)}</p>
                    <p>... large effect size: ${C10 >= 1 ? "-" : C10.toFixed(3)}</p>
                    <p>Interval Scale:</p>
                    <ul>
                        <li>Up to ${intervalC8}: Very weak association</li>
                        <li>${weakAssociation}</li>
                        <li>${moderateAssociation}</li>
                        <li>${strongAssociation}</li>
                    </ul>
                    <br><p></p>
                `;
            }

            if (observedProvided) {
                const I9 = formulas.I9(I2, I3, I7);
                const J9 = formulas.J9(I9);
                const J7 = formulas.J7(I7, B8, B9, B10, 'Very weak association', 'Weak association', 'Moderate association', 'Strong association');

                resultsHtml += `
                    <p>${J7} for the observed Cramer\'s V.</p>
                    <p>Estimated effect size: ${I9.toFixed(3)} ${J9}</p>
                    
                `;
            }

            // Display results
            document.getElementById('results').innerHTML = resultsHtml;
        }
    </script>
            </td>
        </tr>
        </tbody>
    </table></div>
</body>
</html>